"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[6975],{6975:(D,d,s)=>{s.r(d),s.d(d,{UserModule:()=>I});var u=s(6814),m=s(707),g=s(8057),r=s(95),_=s(7853),c=s(3714),h=s(9552),f=s(3530),v=s(8642),Z=s(3617),e=s(4769),b=s(371),T=s(5219),C=s(3965);function U(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",16),e._uU(1," Usu\xe1rios "),e.TgZ(2,"p-button",17),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openFormDialog())}),e.qZA()()}}function A(o,l){1&o&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nome"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Criado em"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Atualizado em"),e.qZA(),e._UZ(9,"th"),e.qZA())}function x(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td")(12,"button",18),e.NdJ("click",function(){const a=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.editRecord(a))}),e.qZA(),e.TgZ(13,"button",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.deleteRecord(a))}),e.qZA()()()}if(2&o){const t=l.$implicit;e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(e.lcZ(7,4,t.created_at)),e.xp6(3),e.Oqu(e.lcZ(10,6,t.updated_at))}}const w=function(){return{width:"100%"}};function N(o,l){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"p-dropdown",20),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Akn(e.DdM(4,w)),e.Q6J("options",t.companies)("showClear",!0)}}function y(o,l){1&o&&(e.TgZ(0,"div",10),e._UZ(1,"p-checkbox",21),e.qZA()),2&o&&(e.xp6(1),e.Q6J("value",!0)("binary",!0))}let S=(()=>{class o{get showFormDialog(){return this._showFormDialog}set showFormDialog(t){this._showFormDialog=t,t||(this.recordSelected=null)}get records(){return this._userService.users}get companies(){return this._companyService.companies}get isSuperadmin(){return this._userService.user.superadmin}constructor(t,n){this._userService=t,this._companyService=n,this._showFormDialog=!1,this.recordSelected=null,this.formGroup=new r.cw({id:new r.NI(null,{validators:[]}),name:new r.NI(null,{validators:[r.kI.required]}),email:new r.NI(null,{validators:[r.kI.required,r.kI.email]}),password:new r.NI(null,{validators:[]}),admin:new r.NI(null,{validators:[]}),superadmin:new r.NI(null,{validators:[]}),company_id:new r.NI(null,{validators:[]})})}openFormDialog(t=null){t?Object.entries(t).forEach(([n,i])=>{this.formGroup.get(n)?.setValue(i)}):Object.entries(this.formGroup.value).forEach(([n,i])=>{this.formGroup.get(n).setValue(null)}),this.formGroup.markAsPristine(),this.formGroup.markAsUntouched(),this.recordSelected=t,this.showFormDialog=!0}closeFormDialog(){this.showFormDialog=!1,this.formGroup.markAsPristine(),this.formGroup.markAsUntouched(),this.recordSelected=null}editRecord(t){this.openFormDialog(t)}deleteRecord(t){this._userService.delete(t).subscribe()}save(){let t={};Object.entries(this.formGroup.value).forEach(([n,i])=>{this.formGroup.get(n).markAsDirty(),this.formGroup.get(n).markAsTouched(),("password"!=n&&"admin"!=n&&"superadmin"!=n||null!=i)&&(t[n]=i)}),this.formGroup.valid&&this._userService.save(t).subscribe({next:()=>{this.closeFormDialog()}})}ngOnInit(){this._userService.load().subscribe(),this._companyService.load().subscribe()}static#e=this.\u0275fac=function(n){return new(n||o)(e.Y36(b.K),e.Y36(Z.J))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-user"]],features:[e._Bn([Z.J])],decls:17,vars:10,consts:[[3,"value"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["header","Usu\xe1rio",3,"visible","formGroup","modal","draggable","resizable","visibleChange"],[2,"width","50vw"],["pInputText","","placeholder","Nome","formControlName","name",2,"width","100%"],["pInputText","","placeholder","Email","formControlName","email",2,"width","100%","margin-top","0.5rem"],["pInputText","","placeholder","Senha","type","password","formControlName","password",2,"width","100%","margin-top","0.5rem","margin-bottom","0.5rem"],[4,"ngIf"],[2,"margin-top","0.5rem"],["formControlName","admin","label","admin",3,"value","binary"],["style","margin-top: 0.5rem;",4,"ngIf"],[2,"display","flex","justify-content","flex-end","margin-top","0.5rem"],["severity","secondary","label","Cancelar",3,"onClick"],["severity","primary","label","Salvar",3,"onClick"],[1,"flex","align-items-center","justify-content-between"],["icon","pi pi-plus",3,"onClick"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],["formControlName","company_id","optionLabel","name","optionValue","id","placeholder","Selecione uma empresa",3,"options","showClear"],["formControlName","superadmin","label","superadmin",3,"value","binary"]],template:function(n,i){1&n&&(e.TgZ(0,"p-table",0),e.YNc(1,U,3,0,"ng-template",1),e.YNc(2,A,10,0,"ng-template",2),e.YNc(3,x,14,8,"ng-template",3),e.qZA(),e.TgZ(4,"p-dialog",4),e.NdJ("visibleChange",function(p){return i.showFormDialog=p}),e.TgZ(5,"div",5),e._UZ(6,"input",6)(7,"input",7)(8,"input",8),e.YNc(9,N,2,5,"div",9),e.TgZ(10,"div",10),e._UZ(11,"p-checkbox",11),e.qZA(),e.YNc(12,y,2,2,"div",12),e.TgZ(13,"div",13)(14,"p-button",14),e.NdJ("onClick",function(){return i.closeFormDialog()}),e.qZA(),e._uU(15," \xa0\xa0\xa0 "),e.TgZ(16,"p-button",15),e.NdJ("onClick",function(){return i.save()}),e.qZA()()()()),2&n&&(e.Q6J("value",i.records),e.xp6(4),e.Q6J("visible",i.showFormDialog)("formGroup",i.formGroup)("modal",!0)("draggable",!1)("resizable",!1),e.xp6(5),e.Q6J("ngIf",i.isSuperadmin),e.xp6(2),e.Q6J("value",!0)("binary",!0),e.xp6(1),e.Q6J("ngIf",i.isSuperadmin))},dependencies:[u.O5,m.Hq,m.zx,T.jx,g.XZ,c.o,r.Fj,r.JJ,r.JL,h.iA,f.V,r.sg,r.u,C.Lt,u.uU],encapsulation:2})}return o})(),F=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[v.Bz.forChild([{path:"",component:S}]),v.Bz]})}return o})();var J=s(1865);let I=(()=>{class o{static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275mod=e.oAB({type:o});static#o=this.\u0275inj=e.cJS({imports:[u.ez,F,m.hJ,g.nD,c.j,r.u5,_.gz,h.U$,f.S,r.u5,r.UX,c.j,J.cc,C.kW]})}return o})()}}]);